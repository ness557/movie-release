<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org" xmlns:sh="http://www.thymeleaf.org">
<head th:replace="embeded/header.html :: header(~{::title})">
    <title th:text="#{lang.title.subs.series}"></title>
</head>
<body>
<nav th:insert="embeded/navbar.html"></nav>

<script th:inline="javascript" th:replace="embeded/subscriptions.html :: series_subscribe"></script>

<div class="container-fluid">
    <div class="alert alert-warning alert-dismissible fade show" role="alert" th:if="${not botInitialized}"
         style="background-color: #F6EAC3; z-index: 999999;margin-bottom: 0">
        <p style="font-size: 18px; font-weight: normal; margin-bottom: 0; color: #A77C43;">
            <span th:text="#{lang.tg_meaasge.please}"></span>
            <strong>
                <a th:href="'tg://resolve?domain=' + ${@environment.getProperty('telegram.bot')}"
                   th:text="#{lang.tg_meaasge.bot}"
                   style="color: #A77C43;" onclick="document.getElementById('modal-notif').remove();">
                </a>
            </strong> <span th:text="#{lang.tg_meaasge.notifications}"></span>
        </p>
        <button type="button" class="close" data-dismiss="alert" aria-label="Close">
            <span aria-hidden="true">&times;</span>
        </button>
    </div>

    <div id="collapse-form">
        <div id="search-bar" style="background-color: #F9F9F9; height: 150%;">
            <form action="/series/subscriptions" method="get" style="height: 100%;">

                <div class="row"
                     style="font-weight: bold;font-family: 'Roboto', sans-serif;font-size: 18px;padding: 10px 20px;">
                    <div class="col" th:text="#{lang.filter}"></div>
                </div>

                <div class="container" style="padding: 0; background-color: #F2F2F2; min-height: 100%">
                    <div class="row"
                         style="font-weight: normal;font-family: 'Roboto', sans-serif;font-size: 16px;padding: 15px 20px 5px 20px">
                        <div class="col"><label th:text="#{lang.status} + ':'"></label></div>
                    </div>

                    <div id="collapseFilter" style="padding: 15px 20px;">

                        <th:block
                                th:each="status : ${T(com.ness.movie_release_web.model.wrapper.tmdb.tvSeries.details.Status).values()}">
                            <div class="row">
                                <div class="col-1">
                                    <input type="checkbox" class="option-input" th:id="${status.name()}"
                                           name="statuses" th:value="${status}"
                                           th:checked="${statuses != null && statuses.contains(status)}">
                                </div>

                                <div class="col-11"
                                     style="font-family: 'Roboto', sans-serif;font-size: 16px;">
                                    <label th:for="${status.name()}" th:text="#{'lang.status.' + ${status}}"></label>
                                </div>
                            </div>
                        </th:block>
                    </div>


                    <div class="row"
                         style="font-weight: normal;font-family: 'Roboto', sans-serif;font-size: 16px;padding: 15px 20px 5px 20px">
                        <div class="col"><label th:text="#{lang.watch_status}"></label></div>
                    </div>

                    <div id="collapseFilter2" style="padding: 15px 20px;">

                        <th:block
                                th:each="status : ${T(com.ness.movie_release_web.model.wrapper.tmdb.tvSeries.WatchStatus).values()}">
                            <div class="row">
                                <div class="col-1">
                                    <input type="checkbox" class="option-input" name="watch_status" th:value="${status}"
                                           th:id="${status.name()}"
                                           th:checked="${watch_statuses != null && watch_statuses.contains(status)}">
                                </div>

                                <div class="col-11"
                                     style="font-family: 'Roboto', sans-serif;font-size: 16px;">
                                    <label th:for="${status.name()}"
                                           th:text="#{'lang.watchstatus.' + ${status}}"></label>
                                </div>
                            </div>
                        </th:block>
                    </div>

                    <div class="row"
                         style="font-weight: normal;font-family: 'Roboto', sans-serif;font-size: 16px;padding: 15px 20px 5px 20px">
                        <div class="col"><label th:text="#{lang.sort_by} + ':'"></label></div>
                    </div>

                    <div class="row">
                        <div class="col col-centered">
                            <div id="selectSort" style="padding: 15px 20px;">
                                <select th:name="sortBy" class="form-control selectpicker">
                                    <option th:each="sort : ${T(com.ness.movie_release_web.repository.TVSeriesSortBy).values()}"
                                            th:value="${sort}"
                                            th:text="#{'lang.sort.' + ${sort.name()}}"
                                            th:selected="${sort.equals(sortBy)}">
                                    </option>
                                </select>
                            </div>
                        </div>
                    </div>


                    <div class="row" style="padding: 12px 0">
                        <div class="col-centered">
                            <input type="submit" class="btn btn-warning" th:value="#{lang.apply}">
                        </div>
                    </div>
                </div>

            </form>
        </div>
    </div>

    <div id="sidebar-button" style="height: 100%;">
        <a href="javascript:void(0);" id="collapse-button" class="rotated">
            <i class="fas fa-lg fa-angle-right" id="collapse-button-icon"
               style="color: #676767; padding-right: 15px;"></i>
            <span id="collapse-button-text" th:text="#{lang.search_criteria_button_show}"></span>
        </a>
    </div>
</div>


<div class="container-fluid" id="content">
    <th:block th:each="serie, iStat : ${series}">
        <div class="row">

            <div class="col-12 info"
                 style="font-weight: bold; padding-left: 100px;">

                <a th:href="'/series/' + ${serie.id}"
                   style="color: #555555; text-decoration: none;">
                    <span th:text="${serie.name} + ' (' + ${serie.firstAirDate.getYear()} + ')'"/>
                </a>

                <form action="/series/unSubscribe" method="post" class="unSubsForm">
                    <input type="hidden" name="tmdbId" th:value="${serie.id}"/>
                    <input type="submit" th:value="#{lang.unsubscribe}" class="btn btn-danger"/>
                </form>
            </div>
        </div>
    </th:block>
</div>

<div th:if="${series.isEmpty()}" style="height: 35%; color: #C9C9C9; font-size: 20px">
    <div class="row" style="height: 100%;">
        <div class="col-xl-12" style="text-align: center;">
            <span style="bottom: 0; left: 0; right: 0" th:text="#{lang.subs.no_subs}"></span>
            <br>
            <span style="bottom: 0; left: 0; right: 0" th:text="#{lang.subs.to_add}"></span>
        </div>
    </div>
</div>

<div th:replace="embeded/pagination.html :: pagination"></div>

<div class="back-to-top" style="display: inline;">
    <a style="pointer-events: none">
        <img th:src="@{/img/scroll-up-button.png}">
    </a>
</div>

<footer th:insert="embeded/footer.html"></footer>

<script th:inline="javascript">

    var my_switch = true;
    $('#collapse-button').click(function (e) {
        e.preventDefault();
        //move search bar
        $('#search-bar').toggleClass('toggled');
        //resize content
        $('#content').toggleClass('toggled');
        //change bootstrap grid sizes
        $(".info").toggleClass("col-xs-6 col-sm-5 col-md-4 col-lg-3 col-xl-2");
        $(".info").toggleClass("col-xs-7 col-sm-6 col-md-5 col-lg-4 col-xl-3");
        $(".offset").toggleClass("offset-xl-1");
        //move sidebar button
        $('#sidebar-button').toggleClass('toggled');
        //change sidebar button text
        $('#collapse-button-icon').toggleClass('fa-angle-right fa-angle-left');
        if (my_switch)
            $('#collapse-button-text').text([[#{lang.search_criteria_button_hide}]]);
        else
            $('#collapse-button-text').text([[#{lang.search_criteria_button_show}]]);
        my_switch = !my_switch;
    });

    $('.selectpicker').selectpicker({
        noneSelectedText: [[#{lang.none_selected_text}]],
        noneResultsText: [[#{lang.none_results_text}]],
        selectAllText: [[#{lang.select_all}]]
    });

    $(".unSubsForm").submit(unsubscribe);
</script>
</body>
</html>